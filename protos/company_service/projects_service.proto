syntax="proto3";

package company_service;
option go_package="genproto/company_service";

import "company.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/empty.proto";
import "billing_service.proto";

service ProjectService {
    rpc Create(CreateProjectRequest) returns (CreateProjectResponse) {}
    rpc GetList(GetProjectListRequest) returns (GetProjectListResponse) {}
    rpc GetById(GetProjectByIdRequest) returns (Project) {}
    rpc Update(Project) returns (Project) {}
    rpc Delete(DeleteProjectRequest) returns (EmptyProto) {}
    rpc GetProjects(GetProjectsRequest) returns (GetProjectsResponse) {}
    rpc GetProjectsByCompanyId(GetProjectsByCompanyIdReq) returns (GetProjectsByCompanyIdRes) {}
    rpc UpdateProjectUserData (UpdateProjectUserDataReq) returns (UpdateProjectUserDataRes) {}
    rpc GetListSetting(GetListSettingReq) returns (Setting) {};

    rpc CreateProjectLoginMicroFront(ProjectLoginMicroFrontend) returns (ProjectLoginMicroFrontend) {};
    rpc GetProjectLoginMicroFront(GetProjectLoginMicroFrontRequest) returns (ProjectLoginMicroFrontend) {};
    rpc UpdateProjectLoginMicroFront(ProjectLoginMicroFrontend) returns (ProjectLoginMicroFrontend) {};

    rpc UpdateProjectConfig (ProjectConfig) returns (ProjectConfig) {};
    rpc GetPorjectConfigByProjectId (GetPorjectConfigByProjectIdRequest) returns (ProjectConfig) {};
    rpc GetProjectConfigList (google.protobuf.Empty) returns (ListPorjectConfig) {};

    rpc UpsertRecord(Record) returns (EmptyProto) {};
    rpc ListRecord(ListRecordRequest) returns(EmptyProto) {};

    rpc ListProjectsRPS(GetProjectListRequest) returns (ListProjectsRPSResponse) {};
}

message GetPorjectConfigByProjectIdRequest {
    string project_id = 1;
}

message ListProjectsRPSResponse {
    map<string, int32> projects = 1;
}

message ListPorjectConfig {
    repeated ProjectConfig configs = 1;
}

message ProjectConfig {
    string id = 1;
    string project_id = 2;
    string CONVERT_TEMPLATE_GRPC_PORT = 3;
    string CONVERT_TEMPLATE_SERVICE_HOST = 4;
    string HTTP_PORT = 5;
    string HTTP_SCHEME = 6;
    string SERVICE_HOST = 7;
    string ANALYTICS_GRPC_PORT = 8;
    string ANALYTICS_SERVICE_HOST = 9;
    string API_REF_GRPC_PORT = 10;
    string API_REF_SERVICE_HOST = 11;
    string CHAT_GRPC_PORT = 12;
    string CHAT_SERVICE_HOST = 13;
    string FUNCTION_GRPC_PORT = 14;
    string FUNCTION_SERVICE_HOST = 15;
    string NOTIFICATION_GRPC_PORT = 16;
    string NOTIFICATION_SERVICE_HOST = 17;
    string OBJECT_BUILDER_GRPC_PORT = 18;
    string OBJECT_BUILDER_HIGH_GRPC_PORT = 19;
    string OBJECT_BUILDER_LOW_GRPC_PORT = 20;
    string OBJECT_BUILDER_SERVICE_HIGHT_HOST = 21;
    string OBJECT_BUILDER_SERVICE_HOST = 22;
    string OBJECT_BUILDER_SERVICE_LOW_HOST = 23;
    string QUERY_GRPC_PORT = 24;
    string QUERY_SERVICE_HOST = 25;
    string SCENARIO_GRPC_PORT = 26;
    string SCENARIO_HTTP_PORT = 27;
    string SCENARIO_SERVICE_HOST = 28;
    string SMS_GRPC_PORT = 29;
    string SMS_SERVICE_HOST = 30;
    string TEMPLATE_GRPC_PORT = 31;
    string TEMPLATE_SERVICE_HOST = 32;
    string VERSIONING_GRPC_PORT = 33;
    string VERSIONING_SERVICE_HOST = 34;
    string MONGO_HOST = 35;
    string MONGO_PORT = 36;
    string COMPANY_SERVICE_MONGO_USER = 37;
    string COMPANY_SERVICE_MONGO_PASSWORD = 38;
    google.protobuf.Struct others = 39;
    string REDIS_HOST = 40;
    string REDIS_PORT = 41;
    string REDIS_DATABASE = 42;
    string REDIS_PASSWORD = 43;
}

message ProjectLoginMicroFrontend {
    string id = 1;
    string project_id = 2;
    string environment_id = 3;
    string microfront_id = 4;
    string subdomain = 5;
}

message GetProjectLoginMicroFrontRequest {
    string id = 1;
    string project_id = 2;
    string subdomain = 3;
}

message Setting {
    google.protobuf.Struct data = 1;
    int32 count = 2;
}

message GetListSettingReq {
    SettingType type = 1;
    string search = 2;
    string project_id = 3;
    int32 limit = 4;
    int32 offset = 5;
}

message UpdateProjectUserDataReq {
    string user_id = 1;
    string project_id = 2;
    string client_type_id = 3;
    string client_platform_id = 4;
    string role_id = 5;
}

message UpdateProjectUserDataRes {

}


message GetProjectsByCompanyIdReq {
    string company_id = 1;
}

message GetProjectsByCompanyIdRes {
    message Company {
        message Project {
            string id = 1;
            string company_id = 2;
            string name = 3;
            string domain = 4;
            string created_at = 5;
            string updated_at = 6;
            string logo = 7;
            string fare_id = 8;
        }
        string id = 1;
        string name = 2;
        string logo = 3;
        string description = 4;
        string created_at = 5;
        string updated_at = 6;
        string owner_id = 7;
        repeated Project projects = 8;
    }

    Company company = 1;
}

message GetProjectsRequest {
    string k8s_namespace = 1;
    string node_type = 2;
}

message AutoConnectByProjectIdRequest {
    string k8s_namespace = 1;
    string project_id = 2;
    string node_type = 3;
}

message GetProjectsResponse {
    string id = 1;
    string title = 2;
    string created_at = 3;
    string updated_at = 4;
    string company_id = 5;
}

message ProjectWithoutResource {
    string id = 1;
    string company_id = 2;
    string k8s_namespace = 3;
    string name = 4;
}

message ResourceWithoutPassword {
    message Credentials {
        string host = 1;
        string port = 2;
        string username = 3;
        string database = 4;
    }
    message Environment {
        string resource_environment_id = 1;
        string name = 2;
        string display_color = 3;
        string description = 4;
        bool is_configured = 5;
        string id = 6;
        bool default = 7;
        string node_type = 8;
    }

    ResourceType resource_type = 1;
    Credentials credentials = 2;
    string id = 3;
    string project_id = 4;
    string title = 5;
    repeated Environment environments = 6;
    string node_type = 7;
}

message Project {
    string project_id = 1;
    string company_id = 2;
    string k8s_namespace = 3;
    string title = 4;
    repeated ResourceWithoutPassword resources = 5;
    string logo = 6;
    repeated Language language = 7;
    Currency currency = 8;
    Timezone timezone = 9;
    string fare_id = 10;
    repeated Currency currencies = 11;
    int32 request_per_second = 12;
    double balance = 13;
    double credit_limit = 14;
    Fare fare = 15;
    string status = 16;
    bool new_design = 17;
}

message CreateProjectRequest {
    string company_id = 1;
    string k8s_namespace = 2;
    string title = 3;
    repeated Resource resources = 4;
}

message CreateProjectResponse {
    string project_id = 1;
}

message GetProjectListRequest {
    int32 limit = 1;
    int32 offset = 2;
    string company_id = 3;
    string search = 4;
    bool active = 5;
}

message GetProjectListResponse {
    int32 count = 1;
    repeated Project projects = 2;
}

message GetProjectByIdRequest {
    string project_id = 1;
    string company_id = 2;
}

message DeleteProjectRequest {
    string project_id = 1;
    string company_id = 2;
}

message EmptyProto {
    
}

message AddResourceRequest {
    string project_id = 1;
    string environment_id = 2;
    ResourceType resource_type = 3;
    string title = 4;
    bool is_configured = 5;
    Resource.Credentials credentials = 6;
    ServiceType service_type = 7;
    string company_id = 8;
    string user_id = 9;
    bool is_default = 10;
    string node_type = 11;
    string client_type_id = 12;
    string role_id = 13;
}

message ConfigureResourceRequest {
    string project_id = 1;
    string environment_id = 2;
    ResourceType resource_type = 3;
    string title = 4;
    bool is_configured = 5;
    Resource.Credentials credentials = 6;
    ServiceType service_type = 7;
    string company_id = 8;
    string user_id = 9;
    string resource_id = 10;
    bool default = 11;
}

message AddResourceInUcodeRequest {
    string project_id = 1;
    string company_id = 2;
    string user_id = 3;
    string project_title = 4;
}

message AddResourceResponse {
    string id = 1;
}

message ConfigureResourceResponse {
    string id = 1;
}

message RemoveResourceRequest {
    string id = 5;
}

message GetResourceRequest {
    string id = 1;
}

message ReconnectResourceRequest {
    string id = 1;
    string project_id = 2;
}

message ReconnectResourceRes {
    message ReconnectStatus {
        ServiceType service_type = 1;
        bool status = 2;
    }
    repeated ReconnectStatus reconnect_status = 1;
}

message GetResourceWithPathResponse {
    message Credentials {
        string host = 1;
        string port = 2;
        string username = 3;
        string database = 4;
    }
    ServiceType service_type = 1;
    ResourceType resource_type = 2;
    Credentials credentials = 3;
    string id = 4;
    string project_id = 5;
    string path = 6;
    string title = 7;
}

message GetResourceManyRequest {
    repeated GetProjectsResponse id = 1;
    string node_type = 2;
}

message AutoConnectByProjectIdResponse {
    message ResourceEnvironment {
        message Credentials {
            string host = 1;
            string port = 2;
            string username = 3;
            string database = 4;
            string password = 5;
        }
        ServiceType service_type = 1;
        ResourceType resource_type = 2;
        Credentials credentials = 3;
        string id = 4;
        string project_id = 5;
        string node_type = 6;
    }
    ResourceEnvironment res = 1;
}

message GetResourceManyWithPathResponse {
    message ResourceEnvironment {
        message Credentials {
            string host = 1;
            string port = 2;
            string username = 3;
            string database = 4;
            string password = 5;
        }
        ServiceType service_type = 1;
        ResourceType resource_type = 2;
        Credentials credentials = 3;
        string id = 4;
        string project_id = 5;
        string path = 6;
        string title = 7;
        string resource_id = 8;
        string environment_id = 9;
        string version_id = 10;
        string node_type = 11;
    }
    repeated ResourceEnvironment res = 1;
}

message GetProjectRes {
    repeated GetProjectsResponse response = 1;
}

message Record {
    string project_id = 1;
    int32 amount = 2;
    string resource_environment_id = 3;
    string table_slug = 4;
}

message ListRecordRequest {

}