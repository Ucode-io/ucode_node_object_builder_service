[{"$lookup":{"from":"buses","localField":"bus_id","foreignField":"guid","as":"bus_id_data"}},{"$group":{"_id":{"athlete":"$athlete","country":"$country","silver":"$silver"},"data":{"$push":{"guid":"$guid","createdAt":"$createdAt","company":"$company","year_str":"$year_str","bus_id":"$bus_id","total":"$total","gold":"$gold","bus_id_data":{"$arrayElemAt":["$bus_id_data",0]}}}}},{"$lookup":{"from":"buses","localField":"bus_id","foreignField":"guid","as":"bus_id_data"}},{"$group":{"_id":{"athlete":"$_id.athlete","country":"$_id.country"},"data":{"$push":{"silver":"$_id.silver","group_by_type":"NUMBER","createdAt":{"$arrayElemAt":["$data.createdAt",0]},"total":"$total","gold":"$gold","data":"$data"}}}},{"$lookup":{"from":"buses","localField":"bus_id","foreignField":"guid","as":"bus_id_data"}},{"$group":{"_id":"$_id.athlete","data":{"$push":{"country":"$_id.country","group_by_type":"SINGLE_LINE","createdAt":{"$arrayElemAt":["$data.createdAt",0]},"total":"$total","gold":"$gold","data":"$data"}}}},{"$addFields":{"athlete":"$_id","group_by_type":"SINGLE_LINE","group_by_slug":"","createdAt":{"$arrayElemAt":["$data.createdAt",0]}}},{"$sort":{"createdAt":-1}}]