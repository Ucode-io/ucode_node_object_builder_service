[{"$lookup":{"from":"shops","localField":"shop_id","foreignField":"guid","as":"shop_id_data"}},{"$group":{"_id":"$shop_id","data":{"$push":{"guid":"$guid","createdAt":"$createdAt","Name":"$Name","gender":"$gender","shop_id":"$shop_id"}}}},{"$lookup":{"from":"shops","localField":"_id","foreignField":"guid","as":"shop_id_data"}},{"$addFields":{"shop_id":"$_id","group_by_type":"LOOKUP","group_by_slug":"shop","createdAt":{"$arrayElemAt":["$data.createdAt",0]}}},{"$sort":{"createdAt":-1}}]